CH344Q 智能控制面板 (Smart Control Panel)
1. 软件简介 | Introduction
本工具专为 CH344Q USB控制板 设计，用于在 Windows 10/11 系统下控制外接设备的 数据传输模式 (Data Mode) 与 超级快充模式 (Fast Charge Mode) 的智能切换。

软件支持两种工作模式：

图形界面模式 (GUI)：适合人工调试，可视化操作，支持独立通道控制。

命令行接口 (CLI)：适合自动化脚本调用 (Python/Bat/C#)，支持静默后台运行。

2. 运行环境 
在使用本软件前，请确保电脑满足以下条件：

操作系统：Windows 10 / Windows 11 (64-bit 推荐)

驱动程序：必须安装沁恒 CH343/CH344 串口驱动 (CH343SER.EXE)。

如果没有安装驱动，设备管理器中会出现黄色感叹号，软件无法搜索到设备。

文件完整性：软件目录下必须包含以下两个文件，缺一不可：

CH343PtDemo.exe (主程序)

CH343PT.DLL (核心驱动库)

3. 手动操作指南 (图形界面)
适用于研发调试或人工测试场景。

连接设备：将 CH344Q 控制板通过 USB 线连接至电脑。

启动软件：双击运行 CH343PtDemo.exe。

自动连接：

软件启动时会自动扫描并连接 CH34x 设备。

连接成功后，顶部状态栏会显示“已连接: COMx”。

如果未连接，请点击顶部的“搜索”按钮刷新列表，然后点击“打开”。

功能切换：

单路控制：点击中间的 J3, J4, J5, J7, J6 按钮，可独立切换某一路的模式。

一键归位：点击底部左侧按钮，所有通道切换至 数据传输模式（默认状态）。

火力全开：点击底部右侧按钮，所有通道切换至 超级快充模式。

4. 脚本调用指南 (命令行接口)
本程序支持命令行参数，执行完指令后会自动退出，全过程无弹窗。非常适合集成到 Python、批处理 (Bat) 或 C# 自动化测试脚本中。

4.1 参数说明
参数指令	功能描述	行为逻辑
-fast	开启快充模式	后台静默启动 -> 搜索设备 -> 5路全部切为快充 -> 自动退出
-data	开启数据模式	后台静默启动 -> 搜索设备 -> 5路全部切为数据 -> 自动退出

导出到 Google 表格

(注：参数不区分大小写，例如 -FAST, /fast 均有效)

4.2 调用示例
场景 A：使用 Windows 批处理 (.bat)
新建文本文件，重命名为 一键快充.bat，写入：

DOS

@echo off
echo 正在切换到快充模式...
:: 调用程序并传入参数 (请确保exe在当前目录或系统路径中)
CH343PtDemo.exe -fast
echo 切换完成！
pause
场景 B：使用 Python 脚本
Python

import os
import time

# 定义程序路径 (建议使用绝对路径，防止找不到)
tool_path = r"C:\Tools\CH343PtDemo.exe"

def set_fast_charge():
    print("正在执行快充切换...")
    # 调用 EXE 并传入 -fast 参数
    ret = os.system(f"{tool_path} -fast")
    if ret == 0:
        print("快充指令发送成功")
    else:
        print("错误：未找到设备或程序异常")

# 执行切换
set_fast_charge()
场景C:使用c语言,直接调标准库函数
int ret = system("CH343PtDemo.exe -fast");


5. 常见问题 (FAQ)
Q1: 双击程序报错“由于找不到 CH343PT.DLL，无法继续执行代码”？

A: 请务必把 CH343PT.DLL 和 exe 放在同一个文件夹里。不能只拷贝 exe 给别人。
Q2: 脚本调用时没反应？

A: 请检查 USB 线是否插好。如果程序找不到 CH34x 设备，它会静默退出，不执行任何操作。建议在设备管理器中确认 COM 口是否存在。

Q3: 为什么会有多个 COM 口？

A: CH344Q 是四通道芯片，会生成多个 COM 口。本程序具备智能搜索功能，会自动识别并连接第一个有效的控制端口，无需人工干预。